
R version 4.3.3 (2024-02-29) -- "Angel Food Cake"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ### example of glmmPQL with offset.
> 
> ### glmmPQL age structured sole egg data example
> ### from "GAMs:An Intro with R" by Simon Wood
> 
> library(MASS)
> if(!requireNamespace("nlme", quietly = TRUE)) q("no")
> 
> options(warn = 2L)
> ## Chapter 2 stuff...
> 
> if(FALSE) { ## script to create solr
+ #require(gamair) # for 'data(sole)'
+ data(sole)
+ sole$off <- log(sole$a.1 - sole$a.0) # model offset term
+ sole$a <-(sole$a.1 + sole$a.0)/2     # mean stage age
+ solr <- sole                         # make copy for rescaling
+ solr$t <- solr$t-mean(sole$t)
+ solr$t <- solr$t/var(sole$t)^0.5
+ solr$la <- solr$la - mean(sole$la)
+ solr$lo <- solr$lo - mean(sole$lo)
+ save(solr, file = "solr.rda", version = 2)
+ } else load("solr.rda")
> 
> solr$station <- factor(with(solr, paste0(-la, -lo, -t)))
> b <- glmmPQL(eggs ~ offset(off) + lo + la + t + I(lo*la) + I(lo^2) +
+             I(la^2) + I(t^2) + I(lo*t) + I(la*t) + I(lo^3) + I(la^3) +
+             I(t^3) + I(lo*la*t) + I(lo^2*la) + I(lo*la^2) + I(lo^2*t) +
+             I(la^2*t) + I(la*t^2) + I(lo*t^2) + a + I(a*t) + I(t^2*a),
+             random = list(station = ~1),
+             family = quasi(link = log, variance = "mu"),
+             data = solr)
iteration 1
iteration 2
iteration 3
iteration 4
iteration 5
iteration 6
iteration 7
iteration 8
iteration 9
iteration 10
> summary(b)
Linear mixed-effects model fit by maximum likelihood
  Data: solr 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 | station
        (Intercept) Residual
StdDev:   0.6837224  1.57999

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  eggs ~ offset(off) + lo + la + t + I(lo * la) + I(lo^2) + I(la^2) +      I(t^2) + I(lo * t) + I(la * t) + I(lo^3) + I(la^3) + I(t^3) +      I(lo * la * t) + I(lo^2 * la) + I(lo * la^2) + I(lo^2 * t) +      I(la^2 * t) + I(la * t^2) + I(lo * t^2) + a + I(a * t) +      I(t^2 * a) 
                   Value Std.Error   DF   t-value p-value
(Intercept)     0.647189 0.2287615 1178  2.829101  0.0047
lo              3.055012 0.5822118  375  5.247252  0.0000
t              -2.636838 0.4691826  375 -5.620068  0.0000
I(lo * la)     -0.447016 0.9547327  375 -0.468211  0.6399
I(lo^2)        -4.039798 0.6283412  375 -6.429306  0.0000
I(la^2)        -4.105339 1.0349804  375 -3.966586  0.0001
I(t^2)         -2.140302 0.4507938  375 -4.747852  0.0000
I(lo * t)       0.031905 0.6787470  375  0.047006  0.9625
I(la * t)       2.777602 0.8091394  375  3.432786  0.0007
I(lo^3)        -2.520459 0.8992937  375 -2.802710  0.0053
I(la^3)        -3.842407 1.3342665  375 -2.879790  0.0042
I(t^3)          0.662864 0.2149722  375  3.083487  0.0022
I(lo * la * t) -3.203234 1.7383593  375 -1.842676  0.0662
I(lo^2 * la)    0.405561 1.4201519  375  0.285576  0.7754
I(lo * la^2)   -6.768105 2.1269979  375 -3.181999  0.0016
I(lo^2 * t)     1.527390 1.0301766  375  1.482648  0.1390
I(la^2 * t)     7.480004 2.0099271  375  3.721530  0.0002
I(la * t^2)    -2.100840 0.7231503  375 -2.905123  0.0039
I(lo * t^2)     1.576723 0.6522985  375  2.417180  0.0161
a              -0.123934 0.0339095 1178 -3.654833  0.0003
I(a * t)        0.100697 0.0720466 1178  1.397667  0.1625
I(t^2 * a)     -0.172837 0.0937249 1178 -1.844091  0.0654
 Correlation: 
               (Intr) lo     t      I(l*l) I(lo^2) I(la^2) I(t^2) I(lo*t)
lo             -0.133                                                    
t               0.160 -0.041                                             
I(lo * la)      0.123  0.124 -0.017                                      
I(lo^2)        -0.411 -0.383 -0.064 -0.143                               
I(la^2)        -0.536  0.035 -0.093 -0.115  0.185                        
I(t^2)         -0.343  0.027  0.464 -0.225  0.066   0.147                
I(lo * t)      -0.137  0.223 -0.270 -0.286  0.051   0.057   0.013        
I(la * t)       0.196  0.025 -0.048  0.246 -0.097  -0.439  -0.400 -0.004 
I(lo^3)         0.049 -0.706  0.049 -0.141  0.164   0.019   0.026 -0.185 
I(la^3)        -0.066  0.014  0.010  0.181 -0.106   0.505   0.071 -0.123 
I(t^3)         -0.041  0.015 -0.371  0.000 -0.057   0.008   0.086 -0.091 
I(lo * la * t) -0.117  0.090  0.179 -0.301  0.075   0.135   0.469  0.320 
I(lo^2 * la)    0.075  0.123  0.054  0.256 -0.046  -0.246   0.029  0.237 
I(lo * la^2)   -0.200 -0.440 -0.080  0.113  0.540   0.317  -0.114 -0.238 
I(lo^2 * t)     0.004 -0.137 -0.303  0.221  0.069   0.037  -0.273 -0.404 
I(la^2 * t)     0.097  0.037 -0.447  0.165 -0.012  -0.265  -0.567  0.308 
I(la * t^2)    -0.215  0.002  0.206 -0.368  0.090   0.211   0.654  0.163 
I(lo * t^2)     0.204 -0.149 -0.298  0.244 -0.154  -0.160  -0.605  0.064 
a              -0.489  0.008 -0.064 -0.001 -0.004  -0.001   0.268  0.005 
I(a * t)       -0.065 -0.014 -0.497  0.011  0.003  -0.008  -0.295 -0.009 
I(t^2 * a)      0.165 -0.020 -0.248  0.013  0.005  -0.009  -0.499 -0.013 
               I(la*t) I(lo^3) I(la^3) I(t^3) I(*l*t I(^2*l I(*l^2 I(lo^2*t)
lo                                                                          
t                                                                           
I(lo * la)                                                                  
I(lo^2)                                                                     
I(la^2)                                                                     
I(t^2)                                                                      
I(lo * t)                                                                   
I(la * t)                                                                   
I(lo^3)        -0.083                                                       
I(la^3)        -0.400   0.084                                               
I(t^3)          0.017  -0.042   0.078                                       
I(lo * la * t) -0.293  -0.054   0.149   0.170                               
I(lo^2 * la)    0.074  -0.112  -0.388   0.057  0.208                        
I(lo * la^2)    0.095   0.038  -0.094  -0.096 -0.345 -0.234                 
I(lo^2 * t)    -0.016   0.171   0.107  -0.080 -0.402 -0.339  0.249          
I(la^2 * t)     0.649  -0.114  -0.341  -0.182 -0.467 -0.004  0.192  0.094   
I(la * t^2)    -0.360   0.006  -0.108   0.040  0.507 -0.011 -0.050 -0.273   
I(lo * t^2)     0.404  -0.048  -0.106   0.011 -0.467  0.028  0.073  0.238   
a              -0.002  -0.002   0.006   0.084  0.010  0.007 -0.012 -0.009   
I(a * t)        0.006   0.007  -0.006   0.150 -0.016 -0.006  0.010  0.016   
I(t^2 * a)      0.007   0.009  -0.009   0.004 -0.022 -0.010  0.016  0.021   
               I(la^2*t) I(la*t^2) I(lo*t^2) a      I(a*t)
lo                                                        
t                                                         
I(lo * la)                                                
I(lo^2)                                                   
I(la^2)                                                   
I(t^2)                                                    
I(lo * t)                                                 
I(la * t)                                                 
I(lo^3)                                                   
I(la^3)                                                   
I(t^3)                                                    
I(lo * la * t)                                            
I(lo^2 * la)                                              
I(lo * la^2)                                              
I(lo^2 * t)                                               
I(la^2 * t)                                               
I(la * t^2)    -0.446                                     
I(lo * t^2)     0.520    -0.500                           
a              -0.007     0.010    -0.013                 
I(a * t)        0.011    -0.022     0.025     0.016       
I(t^2 * a)      0.015    -0.029     0.034    -0.467  0.580

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-1.512566345 -0.182912257 -0.046763657 -0.002171864 31.382700260 

Number of Observations: 1575
Number of Groups: 394 
> 
> b1 <- update(b, ~ . - I(lo*la*t))
iteration 1
iteration 2
iteration 3
iteration 4
iteration 5
iteration 6
> summary(b1)
Linear mixed-effects model fit by maximum likelihood
  Data: solr 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 | station
        (Intercept)  Residual
StdDev:   0.9552875 0.5765976

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  eggs ~ lo + la + t + I(lo * la) + I(lo^2) + I(la^2) + I(t^2) +      I(lo * t) + I(la * t) + I(lo^3) + I(la^3) + I(t^3) + I(lo^2 *      la) + I(lo * la^2) + I(lo^2 * t) + I(la^2 * t) + I(la * t^2) +      I(lo * t^2) + a + I(a * t) + I(t^2 * a) + offset(off) 
                  Value Std.Error   DF    t-value p-value
(Intercept)    0.024756 0.1809293 1178   0.136828  0.8912
lo             4.645910 0.5146676  375   9.027011  0.0000
la            -4.882892 0.6260975  375  -7.798933  0.0000
t             -2.098648 0.3053100  375  -6.873826  0.0000
I(lo * la)     4.215665 0.8089572  375   5.211233  0.0000
I(lo^2)       -4.895307 0.4573374  375 -10.703928  0.0000
I(la^2)       -5.186128 0.7553011  375  -6.866305  0.0000
I(t^2)        -1.466595 0.1870594  375  -7.840263  0.0000
I(lo * t)     -0.243712 0.3564119  375  -0.683793  0.4945
I(la * t)      1.573251 0.4445135  375   3.539264  0.0005
I(lo^3)       -3.957589 0.6594558  375  -6.001295  0.0000
I(la^3)        5.533717 1.5038907  375   3.679600  0.0003
I(t^3)         0.632860 0.1358986  375   4.656859  0.0000
I(lo^2 * la)   6.708280 1.0849301  375   6.183145  0.0000
I(lo * la^2) -11.557582 1.5039845  375  -7.684642  0.0000
I(lo^2 * t)    0.505664 0.5475014  375   0.923586  0.3563
I(la^2 * t)    4.857804 0.9308344  375   5.218763  0.0000
I(la * t^2)   -0.540220 0.3753096  375  -1.439397  0.1509
I(lo * t^2)    0.814895 0.3200088  375   2.546478  0.0113
a             -0.121313 0.0125380 1178  -9.675598  0.0000
I(a * t)       0.092770 0.0270273 1178   3.432460  0.0006
I(t^2 * a)    -0.187471 0.0362277 1178  -5.174791  0.0000
 Correlation: 
             (Intr) lo     la     t      I(l*l) I(lo^2) I(la^2) I(t^2) I(lo*t)
lo           -0.155                                                           
la            0.199 -0.435                                                    
t             0.000  0.000 -0.067                                             
I(lo * la)    0.120  0.483 -0.540  0.095                                      
I(lo^2)      -0.427 -0.402  0.216  0.016 -0.516                               
I(la^2)      -0.536 -0.086  0.186 -0.062 -0.416  0.218                        
I(t^2)       -0.453 -0.022 -0.047  0.292 -0.123  0.178   0.196                
I(lo * t)    -0.081  0.129  0.009 -0.233 -0.150  0.057   0.032   0.008        
I(la * t)     0.269  0.017  0.119  0.140  0.124 -0.111  -0.405  -0.365 -0.235 
I(lo^3)       0.029 -0.756  0.264  0.005 -0.403  0.302   0.126   0.075 -0.043 
I(la^3)      -0.131  0.351 -0.788  0.006  0.534 -0.304   0.017  -0.008 -0.009 
I(t^3)        0.066 -0.026  0.032 -0.666  0.015 -0.075  -0.011  -0.147 -0.173 
I(lo^2 * la)  0.094  0.346 -0.498  0.098  0.634 -0.319  -0.455  -0.070 -0.015 
I(lo * la^2) -0.147 -0.546  0.423  0.024 -0.553  0.577   0.416   0.130 -0.165 
I(lo^2 * t)   0.015 -0.118  0.107 -0.331 -0.124  0.043   0.109  -0.078 -0.226 
I(la^2 * t)   0.218  0.073  0.032 -0.337  0.006 -0.077  -0.340  -0.450  0.391 
I(la * t^2)  -0.278  0.019 -0.207  0.107 -0.172  0.134   0.221   0.573  0.008 
I(lo * t^2)   0.261 -0.199  0.073 -0.191  0.084 -0.227  -0.122  -0.531 -0.044 
a            -0.217  0.003 -0.001 -0.027  0.003 -0.002  -0.003   0.228  0.000 
I(a * t)     -0.040 -0.006  0.003 -0.283 -0.002  0.002   0.001  -0.237  0.000 
I(t^2 * a)    0.058 -0.007  0.003 -0.148 -0.003  0.004   0.003  -0.398 -0.001 
             I(la*t) I(lo^3) I(la^3) I(t^3) I(^2*l I(*l^2 I(lo^2*t) I(la^2*t)
lo                                                                           
la                                                                           
t                                                                            
I(lo * la)                                                                   
I(lo^2)                                                                      
I(la^2)                                                                      
I(t^2)                                                                       
I(lo * t)                                                                    
I(la * t)                                                                    
I(lo^3)      -0.062                                                          
I(la^3)      -0.232  -0.144                                                  
I(t^3)        0.076  -0.009   0.017                                          
I(lo^2 * la)  0.110  -0.340   0.178  -0.009                                  
I(lo * la^2) -0.085   0.177  -0.457  -0.032 -0.449                           
I(lo^2 * t)  -0.189   0.140  -0.007   0.107 -0.255  0.100                    
I(la^2 * t)   0.386  -0.113  -0.120  -0.043  0.061 -0.116 -0.184             
I(la * t^2)  -0.464   0.043   0.003  -0.146 -0.066  0.132 -0.026    -0.347   
I(lo * t^2)   0.169   0.010   0.028   0.194  0.026 -0.145  0.169     0.222   
a             0.001   0.001   0.003   0.042  0.002 -0.005 -0.002     0.000   
I(a * t)      0.000   0.000  -0.003   0.097 -0.001  0.004  0.002     0.000   
I(t^2 * a)    0.000   0.000  -0.005   0.017 -0.002  0.006  0.003     0.000   
             I(la*t^2) I(lo*t^2) a      I(a*t)
lo                                            
la                                            
t                                             
I(lo * la)                                    
I(lo^2)                                       
I(la^2)                                       
I(t^2)                                        
I(lo * t)                                     
I(la * t)                                     
I(lo^3)                                       
I(la^3)                                       
I(t^3)                                        
I(lo^2 * la)                                  
I(lo * la^2)                                  
I(lo^2 * t)                                   
I(la^2 * t)                                   
I(la * t^2)                                   
I(lo * t^2)  -0.489                           
a             0.000    -0.005                 
I(a * t)     -0.002     0.009    -0.021       
I(t^2 * a)   -0.003     0.012    -0.487  0.610

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-4.53486087 -0.33989540 -0.12648153 -0.01059352  8.68770879 

Number of Observations: 1575
Number of Groups: 394 
> 
> b2 <- update(b1, ~ . - I(lo*t))
iteration 1
iteration 2
iteration 3
iteration 4
iteration 5
iteration 6
iteration 7
> summary(b2)
Linear mixed-effects model fit by maximum likelihood
  Data: solr 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 | station
        (Intercept) Residual
StdDev:   0.9441517 0.585041

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  eggs ~ lo + la + t + I(lo * la) + I(lo^2) + I(la^2) + I(t^2) +      I(la * t) + I(lo^3) + I(la^3) + I(t^3) + I(lo^2 * la) + I(lo *      la^2) + I(lo^2 * t) + I(la^2 * t) + I(la * t^2) + I(lo *      t^2) + a + I(a * t) + I(t^2 * a) + offset(off) 
                  Value Std.Error   DF    t-value p-value
(Intercept)    0.022034 0.1799892 1178   0.122418  0.9026
lo             4.686404 0.5088163  376   9.210405  0.0000
la            -4.870875 0.6248794  376  -7.794904  0.0000
t             -2.151073 0.2961126  376  -7.264375  0.0000
I(lo * la)     4.107455 0.7979904  376   5.147248  0.0000
I(lo^2)       -4.876642 0.4561787  376 -10.690200  0.0000
I(la^2)       -5.155747 0.7527588  376  -6.849135  0.0000
I(t^2)        -1.472029 0.1895561  376  -7.765663  0.0000
I(la * t)      1.508990 0.4335481  376   3.480559  0.0006
I(lo^3)       -3.971469 0.6552510  376  -6.060989  0.0000
I(la^3)        5.531808 1.5024348  376   3.681896  0.0003
I(t^3)         0.618428 0.1330289  376   4.648829  0.0000
I(lo^2 * la)   6.660172 1.0824484  376   6.152877  0.0000
I(lo * la^2) -11.736213 1.4773525  376  -7.944084  0.0000
I(lo^2 * t)    0.424193 0.5306780  376   0.799341  0.4246
I(la^2 * t)    5.115531 0.8584745  376   5.958863  0.0000
I(la * t^2)   -0.544508 0.3791375  376  -1.436175  0.1518
I(lo * t^2)    0.817459 0.3225639  376   2.534253  0.0117
a             -0.121317 0.0127181 1178  -9.538924  0.0000
I(a * t)       0.092787 0.0274092 1178   3.385243  0.0007
I(t^2 * a)    -0.187441 0.0367342 1178  -5.102629  0.0000
 Correlation: 
             (Intr) lo     la     t      I(l*l) I(lo^2) I(la^2) I(t^2) I(l*t)
lo           -0.152                                                          
la            0.205 -0.440                                                   
t            -0.012  0.020 -0.064                                            
I(lo * la)    0.105  0.510 -0.545  0.058                                     
I(lo^2)      -0.423 -0.413  0.215  0.027 -0.512                              
I(la^2)      -0.535 -0.087  0.182 -0.057 -0.405  0.215                       
I(t^2)       -0.454 -0.017 -0.053  0.300 -0.123  0.176   0.193               
I(la * t)     0.264  0.042  0.133  0.090  0.074 -0.105  -0.410  -0.375       
I(lo^3)       0.027 -0.757  0.261  0.006 -0.409  0.306   0.123   0.077 -0.066
I(la^3)      -0.137  0.356 -0.789  0.001  0.544 -0.302   0.022  -0.003 -0.251
I(t^3)        0.051  0.002  0.031 -0.733 -0.008 -0.070  -0.008  -0.137  0.033
I(lo^2 * la)  0.089  0.347 -0.499  0.099  0.636 -0.316  -0.451  -0.065  0.107
I(lo * la^2) -0.160 -0.538  0.431 -0.013 -0.589  0.595   0.430   0.125 -0.132
I(lo^2 * t)  -0.014 -0.077  0.112 -0.406 -0.161  0.076   0.120  -0.070 -0.253
I(la^2 * t)   0.272  0.025  0.035 -0.278  0.063 -0.107  -0.383  -0.493  0.536
I(la * t^2)  -0.280  0.023 -0.211  0.112 -0.173  0.133   0.217   0.577 -0.469
I(lo * t^2)   0.265 -0.198  0.080 -0.194  0.083 -0.226  -0.123  -0.541  0.172
a            -0.222  0.003 -0.001 -0.028  0.004 -0.003  -0.003   0.229  0.001
I(a * t)     -0.040 -0.006  0.003 -0.296 -0.002  0.002   0.001  -0.238  0.000
I(t^2 * a)    0.060 -0.008  0.004 -0.155 -0.003  0.004   0.003  -0.399  0.000
             I(lo^3) I(la^3) I(t^3) I(^2*l I(*l^2 I(lo^2*t) I(la^2*t) I(la*t^2)
lo                                                                             
la                                                                             
t                                                                              
I(lo * la)                                                                     
I(lo^2)                                                                        
I(la^2)                                                                        
I(t^2)                                                                         
I(la * t)                                                                      
I(lo^3)                                                                        
I(la^3)      -0.144                                                            
I(t^3)       -0.017   0.018                                                    
I(lo^2 * la) -0.332   0.178  -0.011                                            
I(lo * la^2)  0.173  -0.460  -0.066 -0.457                                     
I(lo^2 * t)   0.103  -0.012   0.067 -0.269  0.077                              
I(la^2 * t)  -0.101  -0.129   0.025  0.066 -0.066 -0.102                       
I(la * t^2)   0.043   0.007  -0.139 -0.060  0.126 -0.023    -0.381             
I(lo * t^2)   0.002   0.020   0.171  0.024 -0.144  0.131     0.263    -0.496   
a             0.001   0.003   0.044  0.002 -0.005 -0.002     0.000     0.000   
I(a * t)      0.000  -0.003   0.100 -0.002  0.004  0.003     0.001    -0.003   
I(t^2 * a)    0.000  -0.005   0.017 -0.002  0.006  0.004     0.001    -0.003   
             I(lo*t^2) a      I(a*t)
lo                                  
la                                  
t                                   
I(lo * la)                          
I(lo^2)                             
I(la^2)                             
I(t^2)                              
I(la * t)                           
I(lo^3)                             
I(la^3)                             
I(t^3)                              
I(lo^2 * la)                        
I(lo * la^2)                        
I(lo^2 * t)                         
I(la^2 * t)                         
I(la * t^2)                         
I(lo * t^2)                         
a            -0.005                 
I(a * t)      0.010    -0.021       
I(t^2 * a)    0.013    -0.487  0.609

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-4.4684889 -0.3346654 -0.1222186 -0.0108954  9.5365062 

Number of Observations: 1575
Number of Groups: 394 
> 
> b3 <- update(b2, ~ . - I(lo^2*t))
iteration 1
iteration 2
iteration 3
iteration 4
iteration 5
iteration 6
iteration 7
> summary(b3)
Linear mixed-effects model fit by maximum likelihood
  Data: solr 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 | station
        (Intercept)  Residual
StdDev:   0.9470239 0.5845063

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  eggs ~ lo + la + t + I(lo * la) + I(lo^2) + I(la^2) + I(t^2) +      I(la * t) + I(lo^3) + I(la^3) + I(t^3) + I(lo^2 * la) + I(lo *      la^2) + I(la^2 * t) + I(la * t^2) + I(lo * t^2) + a + I(a *      t) + I(t^2 * a) + offset(off) 
                  Value Std.Error   DF    t-value p-value
(Intercept)    0.025239 0.1801166 1178   0.140126  0.8886
lo             4.722893 0.5099248  377   9.261941  0.0000
la            -4.929562 0.6230096  377  -7.912498  0.0000
t             -2.055204 0.2711892  377  -7.578489  0.0000
I(lo * la)     4.217890 0.7900958  377   5.338454  0.0000
I(lo^2)       -4.915890 0.4543699  377 -10.819136  0.0000
I(la^2)       -5.233242 0.7517987  377  -6.960962  0.0000
I(t^2)        -1.464005 0.1886069  377  -7.762204  0.0000
I(la * t)      1.596940 0.4209017  377   3.794092  0.0002
I(lo^3)       -4.030071 0.6533174  377  -6.168627  0.0000
I(la^3)        5.548586 1.5057096  377   3.685031  0.0003
I(t^3)         0.610431 0.1331596  377   4.584207  0.0000
I(lo^2 * la)   6.905257 1.0458246  377   6.602692  0.0000
I(lo * la^2) -11.840029 1.4729803  377  -8.038145  0.0000
I(la^2 * t)    5.190761 0.8541175  377   6.077338  0.0000
I(la * t^2)   -0.539635 0.3789933  377  -1.423864  0.1553
I(lo * t^2)    0.783573 0.3216222  377   2.436316  0.0153
a             -0.121296 0.0127032 1178  -9.548397  0.0000
I(a * t)       0.092722 0.0273788 1178   3.386643  0.0007
I(t^2 * a)    -0.187561 0.0366998 1178  -5.110685  0.0000
 Correlation: 
             (Intr) lo     la     t      I(l*l) I(lo^2) I(la^2) I(t^2) I(l*t)
lo           -0.154                                                          
la            0.210 -0.434                                                   
t            -0.022 -0.015 -0.019                                            
I(lo * la)    0.102  0.501 -0.538 -0.013                                     
I(lo^2)      -0.421 -0.411  0.205  0.073 -0.504                              
I(la^2)      -0.534 -0.079  0.173 -0.009 -0.396  0.203                       
I(t^2)       -0.456 -0.021 -0.045  0.298 -0.138  0.181   0.203               
I(la * t)     0.267  0.020  0.159 -0.013  0.044 -0.080  -0.405  -0.411       
I(lo^3)       0.027 -0.758  0.254  0.054 -0.400  0.309   0.113   0.085 -0.039
I(la^3)      -0.139  0.356 -0.790 -0.006  0.547 -0.301   0.027  -0.004 -0.266
I(t^3)        0.052  0.002  0.024 -0.773  0.003 -0.077  -0.017  -0.138  0.053
I(lo^2 * la)  0.087  0.335 -0.491 -0.014  0.625 -0.305  -0.442  -0.088  0.067
I(lo * la^2) -0.158 -0.537  0.425  0.024 -0.583  0.589   0.426   0.128 -0.117
I(la^2 * t)   0.267  0.026  0.039 -0.351  0.064 -0.096  -0.384  -0.502  0.532
I(la * t^2)  -0.279  0.023 -0.212  0.112 -0.178  0.133   0.220   0.575 -0.497
I(lo * t^2)   0.266 -0.199  0.065 -0.152  0.109 -0.231  -0.138  -0.532  0.221
a            -0.222  0.003 -0.001 -0.031  0.003 -0.002  -0.003   0.230  0.000
I(a * t)     -0.040 -0.006  0.002 -0.321 -0.002  0.002   0.001  -0.239  0.001
I(t^2 * a)    0.060 -0.008  0.003 -0.167 -0.003  0.003   0.002  -0.401  0.001
             I(lo^3) I(la^3) I(t^3) I(^2*l I(*l^2 I(^2*t I(la*t^2) I(lo*t^2)
lo                                                                          
la                                                                          
t                                                                           
I(lo * la)                                                                  
I(lo^2)                                                                     
I(la^2)                                                                     
I(t^2)                                                                      
I(la * t)                                                                   
I(lo^3)                                                                     
I(la^3)      -0.147                                                         
I(t^3)       -0.016   0.019                                                 
I(lo^2 * la) -0.313   0.177   0.009                                         
I(lo * la^2)  0.172  -0.459  -0.074 -0.451                                  
I(la^2 * t)  -0.101  -0.130   0.033  0.058 -0.063                           
I(la * t^2)   0.044   0.008  -0.143 -0.065  0.126 -0.387                    
I(lo * t^2)  -0.007   0.022   0.178  0.063 -0.148  0.267 -0.494             
a             0.001   0.003   0.044  0.001 -0.005  0.000  0.000    -0.005   
I(a * t)      0.000  -0.003   0.099 -0.001  0.004  0.001 -0.002     0.010   
I(t^2 * a)   -0.001  -0.005   0.017 -0.001  0.006  0.001 -0.003     0.013   
             a      I(a*t)
lo                        
la                        
t                         
I(lo * la)                
I(lo^2)                   
I(la^2)                   
I(t^2)                    
I(la * t)                 
I(lo^3)                   
I(la^3)                   
I(t^3)                    
I(lo^2 * la)              
I(lo * la^2)              
I(la^2 * t)               
I(la * t^2)               
I(lo * t^2)               
a                         
I(a * t)     -0.021       
I(t^2 * a)   -0.487  0.610

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-4.47222130 -0.33511066 -0.12492396 -0.01028218  9.05458074 

Number of Observations: 1575
Number of Groups: 394 
> 
> b4 <- update(b3, ~ . - I(la*t^2))
iteration 1
iteration 2
iteration 3
iteration 4
iteration 5
iteration 6
> summary(b4)
Linear mixed-effects model fit by maximum likelihood
  Data: solr 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 | station
        (Intercept)  Residual
StdDev:      0.9599 0.5777944

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  eggs ~ lo + la + t + I(lo * la) + I(lo^2) + I(la^2) + I(t^2) +      I(la * t) + I(lo^3) + I(la^3) + I(t^3) + I(lo^2 * la) + I(lo *      la^2) + I(la^2 * t) + I(lo * t^2) + a + I(a * t) + I(t^2 *      a) + offset(off) 
                  Value Std.Error   DF    t-value p-value
(Intercept)   -0.049547 0.1743339 1178  -0.284206  0.7763
lo             4.747883 0.5110118  378   9.291143  0.0000
la            -5.143326 0.6089753  378  -8.445870  0.0000
t             -2.008674 0.2712491  378  -7.405273  0.0000
I(lo * la)     4.061699 0.7803877  378   5.204719  0.0000
I(lo^2)       -4.843332 0.4497186  378 -10.769696  0.0000
I(la^2)       -5.029643 0.7357839  378  -6.835761  0.0000
I(t^2)        -1.317155 0.1529247  378  -8.613092  0.0000
I(la * t)      1.297544 0.3497181  378   3.710256  0.0002
I(lo^3)       -3.996332 0.6528026  378  -6.121807  0.0000
I(la^3)        5.575868 1.5153318  378   3.679635  0.0003
I(t^3)         0.582007 0.1320531  378   4.407371  0.0000
I(lo^2 * la)   6.855926 1.0437094  378   6.568807  0.0000
I(lo * la^2) -11.587016 1.4600908  378  -7.935819  0.0000
I(la^2 * t)    4.716910 0.7714383  378   6.114435  0.0000
I(lo * t^2)    0.565983 0.2752937  378   2.055926  0.0405
a             -0.121303 0.0125533 1178  -9.663037  0.0000
I(a * t)       0.092647 0.0270629 1178   3.423403  0.0006
I(t^2 * a)    -0.187664 0.0362865 1178  -5.171746  0.0000
 Correlation: 
             (Intr) lo     la     t      I(l*l) I(lo^2) I(la^2) I(t^2) I(l*t)
lo           -0.152                                                          
la            0.158 -0.437                                                   
t             0.004 -0.019  0.006                                            
I(lo * la)    0.062  0.517 -0.598  0.003                                     
I(lo^2)      -0.406 -0.418  0.243  0.062 -0.494                              
I(la^2)      -0.507 -0.085  0.229 -0.023 -0.382  0.183                       
I(t^2)       -0.389 -0.036  0.084  0.284 -0.042  0.128   0.101               
I(la * t)     0.154  0.026  0.072  0.063 -0.038 -0.014  -0.336  -0.184       
I(lo^3)       0.038 -0.760  0.270  0.049 -0.399  0.308   0.108   0.071 -0.022
I(la^3)      -0.135  0.354 -0.808 -0.003  0.554 -0.306   0.022  -0.011 -0.305
I(t^3)        0.017  0.005 -0.010 -0.778 -0.018 -0.061   0.005  -0.070 -0.045
I(lo^2 * la)  0.080  0.334 -0.514 -0.010  0.625 -0.306  -0.444  -0.063  0.050
I(lo * la^2) -0.134 -0.539  0.464  0.014 -0.579  0.583   0.413   0.072 -0.048
I(la^2 * t)   0.181  0.033 -0.041 -0.349  0.005 -0.047  -0.325  -0.371  0.368
I(lo * t^2)   0.158 -0.228 -0.043 -0.112 -0.002 -0.177  -0.046  -0.345 -0.002
a            -0.226  0.003 -0.001 -0.031  0.003 -0.002  -0.002   0.280 -0.001
I(a * t)     -0.041 -0.005  0.002 -0.317 -0.002  0.002   0.001  -0.289  0.001
I(t^2 * a)    0.061 -0.007  0.002 -0.165 -0.003  0.003   0.002  -0.486  0.001
             I(lo^3) I(la^3) I(t^3) I(^2*l I(*l^2 I(^2*t I(*t^2 a      I(a*t)
lo                                                                           
la                                                                           
t                                                                            
I(lo * la)                                                                   
I(lo^2)                                                                      
I(la^2)                                                                      
I(t^2)                                                                       
I(la * t)                                                                    
I(lo^3)                                                                      
I(la^3)      -0.148                                                          
I(t^3)       -0.011   0.020                                                  
I(lo^2 * la) -0.312   0.173   0.004                                          
I(lo * la^2)  0.168  -0.465  -0.059 -0.446                                   
I(la^2 * t)  -0.094  -0.140  -0.014  0.042 -0.006                            
I(lo * t^2)   0.026   0.028   0.129  0.034 -0.104  0.108                     
a             0.001   0.003   0.044  0.001 -0.004 -0.001 -0.006              
I(a * t)      0.000  -0.003   0.098 -0.001  0.004  0.001  0.009 -0.021       
I(t^2 * a)    0.000  -0.004   0.016 -0.001  0.006  0.002  0.013 -0.487  0.610

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-4.52843771 -0.33563645 -0.12901366 -0.01259329  8.73588363 

Number of Observations: 1575
Number of Groups: 394 
> 
> pdf("glmmPQL.pdf")
> fv <- exp(fitted(b4))    # fitted values include offset from 3.1-158
> resid <- solr$eggs - fv  # raw residuals
> sqrt_fv <- sqrt(fv)
> plot(sqrt_fv, sqrt(solr$eggs))
> abline(0, 1, lwd = 2)
> plot(sqrt_fv, resid/sqrt_fv)
> plot(sqrt_fv, resid)
> fl <- sort(sqrt_fv)
> ## add 1 s.d. and 2 s.d. reference lines
> lines(fl, fl); lines(fl, -fl); lines(fl, 2 * fl, lty = 2)
> lines(fl, -2 * fl, lty = 2)
> 
> nlme::intervals(b4, which = "var-cov")
Approximate 95% confidence intervals

 Random Effects:
  Level: station 
                    lower   est.    upper
sd((Intercept)) 0.8278752 0.9599 1.112979

 Within-group standard error:
    lower      est.     upper 
0.5565078 0.5777944 0.5998953 
> 
> head(p1 <- predict(b))
0.8205695238095250.3816857142857141.50693633236918 
                                         -3.557874 
0.7855695238095210.6576857142857141.50693633236918 
                                         -4.514076 
0.7525695238095270.9016857142857141.50693633236918 
                                         -5.833469 
0.6975695238095270.6616857142857141.50693633236918 
                                         -4.695118 
0.6875695238095220.4136857142857141.50693633236918 
                                         -3.414631 
0.6845695238095220.1736857142857141.50693633236918 
                                         -2.553770 
> head(p2 <- predict(b, solr))
0.8205695238095250.3816857142857141.50693633236918 
                                         -3.557874 
0.7855695238095210.6576857142857141.50693633236918 
                                         -4.514076 
0.7525695238095270.9016857142857141.50693633236918 
                                         -5.833469 
0.6975695238095270.6616857142857141.50693633236918 
                                         -4.695118 
0.6875695238095220.4136857142857141.50693633236918 
                                         -3.414631 
0.6845695238095220.1736857142857141.50693633236918 
                                         -2.553770 
> all.equal(p1, p2, check.attributes = FALSE)
[1] TRUE
> 
